model1<-lm(Percent.Obese.Adult~Median.Household.Income + Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model1, direction="both")
summary(step)
colnames(Health14)[23]<-"PercentNative"
colnames(Health14)[23]<-"PercentNative"
colnames(Health14)[25]<-"PercentPacific"
model1<-lm(Percent.Obese.Adult~Median.Household.Income + PercentNative +PercentPacific+Percent.Excessive.Drinking+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model1, direction="both")
summary(step)
colnames(Health14)[62]<-"PercentLongCommute"
colnames(Health14)[65]<-"Drinkingwaterviolation"
model1<-lm(Percent.Obese.Adult~Median.Household.Income +PercentLongCommute+Drinkingwaterviolation+Percent.Excessive.Drinking+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model1, direction="both")
summary(step)
model1<-lm(Percent.Obese.Adult~Median.Household.Income +Pollution+Percent.Severe.Housing.Problems+PercentLongCommute+Drinkingwaterviolation+Percent.Excessive.Drinking+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model1, direction="both")
summary(step)
model1<-lm(Percent.Obese.Adult~Median.Household.Income Other.PCP.Rate+PercentLongCommute+Drinkingwaterviolation+Percent.Excessive.Drinking+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model1, direction="both")
summary(step)
model1<-lm(Percent.Obese.Adult~Median.Household.Income +Other.PCP.Rate+PercentLongCommute+Drinkingwaterviolation+Percent.Excessive.Drinking+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model1, direction="both")
summary(step)
model1<-lm(Percent.Obese.Adult~Median.Household.Income +Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Percent.Excessive.Drinking+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model1, direction="both")
summary(step)
model1<-lm(Percent.Obese.Adult~Median.Household.Income *Percent.African.American +Median.Household.Income *Percent.Hispanic+Median.Household.Income *Percent.Non.Hispanic.White+Median.Household.Income * Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
summary(model1)
step <- stepAIC(model1, direction="both")
summary(step)
summary(model1)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate*Percent.African.American +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed*Percent.African.American + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
hold.Income  +Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65 +Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed + Percent.Some.College + High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed  + High.School.Graduation.Rate *Percent.African.American+High.School.Graduation.Rate *Percent.Hispanic+ regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
Percent.African.American + Percent.Asian + Percent.Non.Hispanic.White + Percent.Hispanic
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed  + High.School.Graduation.Rate *Percent.African.American+High.School.Graduation.Rate *Percent.Hispanic+ regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed  + High.School.Graduation.Rate*Percent.African.American +High.School.Graduation.Rate *Percent.Hispanic+ regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed  + High.School.Graduation.Rate*Percent.African.American +High.School.Graduation.Rate *Percent.Hispanic+ regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index*Percent.African.American + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate*Percent.African.American + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate*Percent.Non.Hispanic.White +Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate*Percent.African.American + MHP.Rate*Percent.Hispanic+Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days*Percent.African.American+Mentally.Unhealthy.Days*Hispanic+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate+Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days*Percent.African.American+Mentally.Unhealthy.Days*Percent.Hispanic+ Percent.Drive.Alone +Percent.Physically.Inactive+ MHP.Rate+Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers + Food.Environment.Index + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days*Percent.Rural+ Percent.Drive.Alone +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate+Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income*Percent.Rural+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days*Percent.Rural+ Percent.Drive.Alone +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate+Percent.Adults.Uninsured + PercentOlder65  + Percent.Rural + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed +High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured*Percent.Rural+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate+Percent.Adults.Uninsured + PercentOlder65   + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress + Percent.Frequent.Physical.Distress + Percent.Unemployed*Percent.Rural+High.School.Graduation.Rate + regionNotExcellus + regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure*Percent.Rural +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate*Percent.Rural + Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured*Percent.Rural+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone*Percent.Rural +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate + PercentOlder65   + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress*Percent.Rural + Percent.Frequent.Physical.Distress + Percent.Unemployed*Percent.Rural+High.School.Graduation.Rate + regionNotExcellus*Percent.African.American+ regionRochester*Percent.Rural + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure*Percent.Rural +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate+ Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+Percent.Some.College*Percent.Rural+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate + PercentOlder65   + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress*Percent.Rural + Percent.Frequent.Physical.Distress*Percent.Rural + Percent.Unemployed*Percent.Rural+High.School.Graduation.Rate + regionNotExcellus+ regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure*Percent.Rural +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate+ Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+Percent.Some.College*Percent.Rural+ Percent.Some.College*Percent.African.American^2 +Percent.Some.College*Percent.Hispanic^2+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate + PercentOlder65   + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress*Percent.Rural + Percent.Frequent.Physical.Distress*Percent.Rural + Percent.Unemployed*Percent.Rural+High.School.Graduation.Rate + regionNotExcellus+ regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure*Percent.Rural +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise +Violent.Crime.Rate+ Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+Percent.Some.College*Percent.Rural+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate + PercentOlder65*Percent.Rural  + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress*Percent.Rural + Percent.Frequent.Physical.Distress*Percent.Rural + Percent.Unemployed*Percent.Rural+High.School.Graduation.Rate + regionNotExcellus+ regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure*Percent.Rural +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise*Percent.Rural +Violent.Crime.Rate*Percent.Rural+ Percent.Under.18.Years*Percent.Rural, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
model2<-lm(Percent.Obese.Adult~Median.Household.Income+Percent.Some.College*Percent.Rural+ Percent.Some.College*Percent.African.American +Percent.Some.College*Percent.Hispanic+ Percent.Some.College*Percent.Non.Hispanic.White+ Percent.Some.College* Percent.Asian+Percent.Adults.Uninsured+PercentLongCommute+Drinkingwaterviolation+Mentally.Unhealthy.Days+ Percent.Drive.Alone +Percent.Physically.Inactive*Percent.Rural+ MHP.Rate + PercentOlder65*Percent.Rural  + Percent.Smokers*Percent.Rural + Food.Environment.Index*Percent.Rural + Percent.Frequent.Mental.Distress*Percent.Rural + Percent.Frequent.Physical.Distress*Percent.Rural + Percent.Unemployed*Percent.Rural+High.School.Graduation.Rate*Percent.Rural + regionNotExcellus+ regionRochester + regionUnivera+ regionUtica+ regionSouthernTier +Percent.Food.Insecure*Percent.Rural +Percent.Insufficient.Sleep + Firearm.Fatalities.Rate + Percent.With.Access.to.Exercise*Percent.Rural +Violent.Crime.Rate*Percent.Rural+ Percent.Under.18.Years, data=Health14)
step <- stepAIC(model2, direction="both")
summary(step)
View(Health14)
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages("shiny")
install.packages(c("dplyr", "flexdashboard", "grpreg", "gtools", "haven", "httpuv", "mice", "pan", "reprex", "rgdal", "robustbase", "stringi"))
install.packages(c("dplyr", "flexdashboard", "grpreg", "gtools", "haven", "httpuv", "mice", "pan", "reprex", "rgdal", "robustbase", "stringi"))
install.packages(c("dplyr", "flexdashboard", "grpreg", "gtools", "haven", "httpuv", "mice", "pan", "reprex", "rgdal", "robustbase", "stringi"))
install.packages(c("dplyr", "flexdashboard", "grpreg", "gtools", "haven", "httpuv", "mice", "pan", "reprex", "rgdal", "robustbase", "stringi"))
install.packages(c("shiny", "dashboard"))
install.packages("shinydashboard")
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(shinydashboard
library(shiny)
library(shinydashboard)
icon("calendar")
icon("calendar")
valueBox(25.1%, The national adult obesity rate, icon="heartbeat", color = "aqua")
valueBox(25.1%, caption=The national adult obesity rate, icon="heartbeat", color = "aqua")
valueBox(25.1%, caption="The national adult obesity rate", icon="heartbeat", color = "aqua")
valueBox(25.1, caption="The national adult obesity rate", icon="heartbeat", color = "aqua")
valueBox(25.1, caption=The national adult obesity rate, icon="heartbeat", color = "aqua")
valueBox(25.1, caption = "The national adult obesity rate", icon="heartbeat", color = "aqua")
valueBox(25.1, caption = "The national adult obesity rate", icon="heartbeat")
valueBox(value=25.1, caption = "The national adult obesity rate", icon="heartbeat")
valueBox(value=25.1, icon="heartbeat")
valueBox(25.1, "Obesityrate", icon=icon("heartbeat"))
output$item<-renderValueBox({
valueBox(25.1, "Obesityrate", icon=icon("heartbeat"), color="aqua")
})
library(shiny)
library(shiny)
install.packages("httpuv")
library(httpuv)
install.packages("shiny")
valueBox(25.1%, "Obesityrate", icon=icon("heartbeat"), color="aqua")
install.packages("scales")
install.packages("scales")
library(scales)
library(scales)
library(scales)
install.packages("scales")
library(scales)
library(scales)
install.packages("httpuv")
library(flexdashboard)
library(shiny)
```{r}
valueBox(value = 25.1, "Obesityrate", icon=icon("heartbeat"), color="cyan"))
renderValueBox({
valueBox(value = 25.1, "Obesityrate", icon=icon("heartbeat"), color="cyan")
})
renderValueBox({
valueBox(value = 25.1, "Obesityrate", icon="fa-heartbeat", color="cyan")
})
```
valueBox(value = 25.1, "Obesityrate", icon="fa-3x-heartbeat", color="cyan")
install.packages("DT")
library(ggplot2)
library(tidyverse)
library(MASS)
library(corrplot)
library(rpart)
library(rpart.plot)
library(Hmisc)
library(flexdashboard)
library(leaflet)
library(maps)
library(tigris)
library(sp)
library(dplyr)
library(leaflet.extras)
library(sf)
library(plotly)
library(DT)
Obesitypal<-colorNumeric("PuRd", domain=newyork@data$Percent.Obese.Adult)
newyork<-counties(state="NY")
Obesitypal<-colorNumeric("PuRd", domain=newyork@data$County)
nymap<-newyork%>%
leaflet()%>%
addProviderTiles("Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red",, , group="NAME")%>%
addSearchFeatures(
targetGroups  = "NAME", options = searchFeaturesOptions(zoom=7))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6)%>%
#addLayersControl(baseGroups = c("Gray Canvas","Detailed"))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap<-newyork%>%
leaflet()%>%
addProviderTiles("Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red",, , group="NAME")%>%
addSearchFeatures(
targetGroups  = "NAME", options = searchFeaturesOptions(zoom=7))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6)%>%
#addLayersControl(baseGroups = c("Gray Canvas","Detailed"))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
Obesitypal<-colorNumeric("PuRd", domain=newyork@data$County)
nymap<-newyork%>%
leaflet()%>%
addProviderTiles("Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red",, , group="NAME")%>%
addSearchFeatures(
targetGroups  = "NAME", options = searchFeaturesOptions(zoom=7))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6)%>%
#addLayersControl(baseGroups = c("Gray Canvas","Detailed"))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
Obesitypal<-colorNumeric("PuRd", domain=newyork@data$County)
knitr::opts_chunk$set(echo = TRUE)
newyork@data<- newyork@data %>%
left_join(Health9, by=c("NAME"="County"))
nymap<-newyork %>%
leaflet()%>%
addProviderTiles("CartoDB", group="Carto")%>%
addProviderTiles("Esri", group="Esri")%>%
addPolygons(weight = 3, stroke= TRUE, color="black", fillColor = ~Obesitypal(Percent.Obese.Adult), fillOpacity = 1, label= ~paste0(NAME, " County Percent Obese = ", Percent.Obese.Adult), highlight = highlightOptions(weight = 5, color = "blue",bringToFront = TRUE))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6.5)%>%
addLayersControl(baseGroups = c("Carto","Esri"))%>%
addSearchOSM%>%
addLegend("topright", pal=Obesitypal, values=~Percent.Obese.Adult, title= "Map Key")
nymap<
nymap<
nymap
nymap
Obesitypal<-colorNumeric("Blues", domain=newyork@data$Percent.Obese.Adult)
Obesitypal<-colorNumeric("RdPu", domain=newyork@data$Percent.Obese.Adult)
nymap<-newyork%>%
leaflet()%>%
addProviderTiles("Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red",, , group="NAME")%>%
addSearchFeatures(
targetGroups  = "NAME", options = searchFeaturesOptions(zoom=7))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6)%>%
#addLayersControl(baseGroups = c("Gray Canvas","Detailed"))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap
nymap<-newyork %>%
leaflet()%>%
addProviderTiles("Esri", group="Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red", group="NAME", label= ~NAME,fillOpacity = 1,  fillColor = ~Obesitypal(Percent.Obese.Adult),  popup = ~paste0("<font color = 'blue'><b>",NAME,"</b></font>", "<font color = 'blue'><b> County</b></font>"),highlight = highlightOptions(weight = 5, color = "blue",bringToFront = TRUE))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6.5)%>%
addSearchFeatures(targetGroups= "NAME", options= searchFeaturesOptions(zoom=8))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap
Obesitypal<-colorNumeric("YlGr", domain=newyork@data$Percent.Obese.Adult)
Obesitypal<-colorNumeric("YlGn", domain=newyork@data$Percent.Obese.Adult)
nymap<-newyork %>%
leaflet()%>%
addProviderTiles("Esri", group="Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red", group="NAME", label= ~NAME,fillOpacity = 1,  fillColor = ~Obesitypal(Percent.Obese.Adult),  popup = ~paste0("<font color = 'blue'><b>",NAME,"</b></font>", "<font color = 'blue'><b> County</b></font>"),highlight = highlightOptions(weight = 5, color = "blue",bringToFront = TRUE))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6.5)%>%
addSearchFeatures(targetGroups= "NAME", options= searchFeaturesOptions(zoom=8))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap<-newyork%>%
leaflet()%>%
addProviderTiles("Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red",, , group="NAME")%>%
addSearchFeatures(
targetGroups  = "NAME", options = searchFeaturesOptions(zoom=7))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6)%>%
#addLayersControl(baseGroups = c("Gray Canvas","Detailed"))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap<-newyork%>%
leaflet()%>%
addProviderTiles("Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red",, , group="NAME")%>%
addSearchFeatures(
targetGroups  = "NAME", options = searchFeaturesOptions(zoom=7))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6)%>%
#addLayersControl(baseGroups = c("Gray Canvas","Detailed"))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap
nymap<-newyork %>%
leaflet()%>%
addProviderTiles("Esri", group="Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red", group="NAME", label= ~NAME,fillOpacity = 1,  fillColor = ~Obesitypal(Percent.Obese.Adult),  popup = ~paste0("<font color = 'blue'><b>",NAME,"</b></font>", "<font color = 'blue'><b> County</b></font>"),highlight = highlightOptions(weight = 5, color = "blue",bringToFront = TRUE))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6.5)%>%
addSearchFeatures(targetGroups= "NAME", options= searchFeaturesOptions(zoom=8))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap<-newyork %>%
leaflet()%>%
addProviderTiles("Esri", group="Esri")%>%
addPolygons(weight = 1, stroke= TRUE, color="red", group="NAME", label= ~NAME,fillOpacity = 1,  fillColor = ~Obesitypal(Percent.Obese.Adult),  popup = ~paste0("<font color = 'blue'><b>",NAME,"</b></font>", "<font color = 'blue'><b> County</b></font>"),highlight = highlightOptions(weight = 5, color = "blue",bringToFront = TRUE))%>%
setView(lat =43.0253, lng= -75.9826, zoom=6.5)%>%
addSearchFeatures(targetGroups= "NAME", options= searchFeaturesOptions(zoom=8))%>%
addLegend("topright", pal=Obesitypal, values= ~Percent.Obese.Adult, title= "Map Key")
nymap
df1<-data.frame(vectora,vectorb,vectorc)
series<-c(1,2,3,NA)
mean(series)
countNA<-function(x){
nalogical <-is.na(x)
sum(nalogical == TRUE)
}
countNA(series)
y<-12
z<-14
multiplyby5<-function(z){
y<-5*z
y
}
}
y<-12
z<-14
multiplyby5<-function(z){
y<-5*z
y
}
y<-12
z<-14
multiplyby5<-function(z){
y<-5*z
return(y)
}
multiplyby5<-function(z){
y<-5*z
y
}
multiplyby5(14)
q<-12
countNAmultiplyby2<-function(x){
nalogical <-is.na(x)
sum<-sum(nalogical == TRUE)
q*sum
}
countNAmultiplyby2(series)
data<-rnorm(n=50)
statistics<-function(x, funct){
funct(x)
}
statistics(data)
statistics(data, funct=mean)
statistics(data, funct=mean)
install.packages("KernSmooth")
install.packages("kerns")
library(KernSmooth)
read.csv(file="tau.csv", header=TRUE, sep=",")
read.csv(file="tau.csv", header=TRUE, sep=",")
read.csv(file="tau.csv", header=TRUE, sep=",")
getwd()
getwd()
pollutantmean<-function(directory, pollutant, csvfrom, csvto) {
#Setting Working Directory
directory<-"C:/Users/Nathan/Desktop/specdata"
#The CSVs range from 1:332 However one is listed as 001 so I must use sprintf
id<- sprintf('%0.3d', csvfrom: csvto)
#Creating empty dataframe
dataMerge <- data.frame()
#Setting working Directory
setwd(directory)
#for loop for all the CSVs.
for ( i in seq_along(id)){
index<-paste(id[i], ".csv", sep="")
Readin<-read.csv(index)
dataMerge<-rbind.data.frame(dataMerge, Readin)
}
sulfatemean<-mean(dataMerge$sulfate, na.rm = TRUE)
nitratemean<-mean(dataMerge$nitrate, na.rm = TRUE)
return(c(sulfatemean, nitratemean)
}
pollutantmean<-function(directory, pollutant, csvfrom, csvto) {
#Setting Working Directory
directory<-"C:/Users/Nathan/Desktop/specdata"
#The CSVs range from 1:332 However one is listed as 001 so I must use sprintf
id<- sprintf('%0.3d', csvfrom: csvto)
#Creating empty dataframe
dataMerge <- data.frame()
#Setting working Directory
setwd(directory)
#for loop for all the CSVs.
for ( i in seq_along(id)){
index<-paste(id[i], ".csv", sep="")
Readin<-read.csv(index)
dataMerge<-rbind.data.frame(dataMerge, Readin)
}
sulfatemean<-mean(dataMerge$sulfate, na.rm = TRUE)
nitratemean<-mean(dataMerge$nitrate, na.rm = TRUE)
return(c(sulfatemean, nitratemean)
}
pollutantmean<-function(directory, pollutant, csvfrom, csvto) {
#Setting Working Directory
directory<-"C:/Users/Nathan/Desktop/specdata"
#The CSVs range from 1:332 However one is listed as 001 so I must use sprintf
id<- sprintf('%0.3d', csvfrom: csvto)
#Creating empty dataframe
dataMerge <- data.frame()
#Setting working Directory
setwd(directory)
#for loop for all the CSVs.
for ( i in seq_along(id)){
index<-paste(id[i], ".csv", sep="")
Readin<-read.csv(index)
dataMerge<-rbind.data.frame(dataMerge, Readin)
}
sulfatemean<-mean(dataMerge$sulfate, na.rm = TRUE)
nitratemean<-mean(dataMerge$nitrate, na.rm = TRUE)
return(c(sulfatemean, nitratemean)
}
pollutantmean<-function(directory, pollutant, csvfrom, csvto) {
#Setting Working Directory
directory<-"C:/Users/Nathan/Desktop/specdata"
#The CSVs range from 1:332 However one is listed as 001 so I must use sprintf
id<- sprintf('%0.3d', csvfrom: csvto)
#Creating empty dataframe
dataMerge <- data.frame()
#Setting working Directory
setwd(directory)
#for loop for all the CSVs.
for ( i in seq_along(id)){
index<-paste(id[i], ".csv", sep="")
Readin<-read.csv(index)
dataMerge<-rbind.data.frame(dataMerge, Readin)
}
sulfatemean<-mean(dataMerge$sulfate, na.rm = TRUE)
nitratemean<-mean(dataMerge$nitrate, na.rm = TRUE)
return(c(sulfatemean, nitratemean)
}
pollutantmean<-function(directory, pollutant, csvfrom, csvto) {
#Setting Working Directory
directory<-"C:/Users/Nathan/Desktop/specdata"
#The CSVs range from 1:332 However one is listed as 001 so I must use sprintf
id<- sprintf('%0.3d', csvfrom: csvto)
#Creating empty dataframe
dataMerge <- data.frame()
#Setting working Directory
setwd(directory)
#for loop for all the CSVs.
for ( i in seq_along(id)){
index<-paste(id[i], ".csv", sep="")
Readin<-read.csv(index)
dataMerge<-rbind.data.frame(dataMerge, Readin)
}
sulfatemean<-mean(dataMerge$sulfate, na.rm = TRUE)
nitratemean<-mean(dataMerge$nitrate, na.rm = TRUE)
return(c(sulfatemean, nitratemean))
}
mean<-pollutantmean(pollutant= sulfate, csvfrom = 1, csvto=10)
mean
mean<-pollutantmean(pollutant= sulfate, csvfrom = 70, csvto=72)
mean
mean<-pollutantmean(pollutant= sulfate, csvfrom = 34, csvto=34)
mean
mean<-pollutantmean(pollutant= sulfate, csvfrom = 1, csvto=332)
mean
mean<-pollutantmean(pollutant= sulfate, csvfrom = 1, csvto=332)
mean
cases<-iscomplete(csvfrom = 6, csvto=6)
iscomplete<-function(csvfrom, csvto) {
#Setting Working Directory
directory<-"C:/Users/Nathan/Desktop/specdata"
#The CSVs range from 1:332 However one is listed as 001 so I must use sprintf
id<- sprintf('%0.3d', csvfrom: csvto)
#Creating empty dataframe
dataMerge <- data.frame(matrix(ncol = 2, nrow = 0))
x <- c("idnumber", "complete")
colnames(dataMerge) <- x
#Setting working Directory
setwd(directory)
#for loop for all the CSVs.
for ( i in seq_along(id)){
index<-paste(id[i], ".csv", sep="")
Readin<-read.csv(index)
dataMerge[i,1]<-id[i]
dataMerge[i,2]<-sum(complete.cases(Readin))
}
return(dataMerge)
}
cases<-iscomplete(csvfrom = 6, csvto=6)
View(cases)
cases<-iscomplete(csvfrom = 54, csvto=54)
View(cases)
set.seed(42)
cases<-iscomplete(csvfrom = 332, csvto=1)
use<-sample(332,10)
print(cc[use, "nobs"])
print(cases[use, "nobs"])
correlation<-correlation(csvfrom = 332, csvto=1, threshold=0)
correlation<-correlation(csvfrom = 332, csvto=1, threshold=0)
correlation<-function(csvfrom, csvto, threshold) {
#Setting Working Directory
directory<-"C:/Users/Nathan/Desktop/specdata"
#The CSVs range from 1:332 However one is listed as 001 so I must use sprintf
id<- sprintf('%0.3d', csvfrom: csvto)
#Creating empty dataframe
dataMerge <- data.frame(matrix(ncol = 2, nrow = 0))
x <- c("idnumber", "complete")
colnames(dataMerge) <- x
#Setting working Directory
setwd(directory)
#for loop for all the CSVs.
for ( i in seq_along(id)){
index<-paste(id[i], ".csv", sep="")
Readin<-read.csv(index)
dataMerge[i,1]<-id[i]
if (sum(complete.cases(Readin)) > threshold) {dataMerge[i,2]<-cor(Readin$sulfate,Readin$nitrate, use = "pairwise.complete.obs")}
else {dataMerge[i,2]<-NA}
}
return(dataMerge)
}
correlation<-correlation(csvfrom = 332, csvto=1, threshold=0)
correlation<-sort(correlation)
View(correlation)
mean<-pollutantmean(pollutant= sulfate, csvfrom = 34, csvto=34)
mean
mean
mean<-pollutantmean(pollutant= sulfate, csvfrom = 70, csvto=72)
mean
mean<-pollutantmean(pollutant= sulfate, csvfrom = 10, csvto=10)
mean
mean<-pollutantmean(pollutant= sulfate, csvfrom = 1, csvto=10)
mean
cases<-iscomplete(csvfrom = 6, csvto=6)
cases<
cases
cases<-iscomplete(csvfrom = 6, csvto=6)
cases
cases<-iscomplete(csvfrom = 6, csvto=6)
cases
cases<-iscomplete(csvfrom = 54, csvto=54)
cases<-iscomplete(csvfrom = 54, csvto=54)
cases
